from openai import AzureOpenAI
import re

# Initialize Azure OpenAI client
client = AzureOpenAI(
    api_key="YOUR_AZURE_OPENAI_KEY",
    api_version="2023-05-15",
    azure_endpoint="YOUR_AZURE_ENDPOINT"
)

def get_detection_prompt(text):
    return f"""
    **Task**: Classify if the following text is offensive (False) or normal (True).  
    **Languages Supported**: English, Spanish, French, German, Hindi, etc.  

    **Offensive Language Includes**:  
    - Profanity, slurs, hate speech.  
    - Threats, harassment, or sexually explicit content.  
    - Severe toxicity (e.g., racism, sexism).  

    **Normal Language**:  
    - Polite, neutral, or professional discourse.  
    - No harmful intent.  

    **Examples**:  
    - Normal: "Hello, how are you?" â†’ True  
    - Offensive: "You idiot!" â†’ False  

    **Text to Analyze**:  
    "{text}"  

    **Output Format**:  
    - Return ONLY "True" (normal) or "False" (offensive).  
    """

def detect_offensive_language(text):
    try:
        response = client.chat.completions.create(
            model="gpt-4",  # or your Azure OpenAI model name
            messages=[
                {"role": "system", "content": "You are a multilingual content moderation AI."},
                {"role": "user", "content": get_detection_prompt(text)}
            ],
            temperature=0.0  # Strict classification
        )
        result = response.choices[0].message.content.strip()
        return result == "True"
    except Exception as e:
        print(f"Error: {e}")
        return True  # Fail-safe: Assume non-offensive if error occurs

def format_output(text, language_code="en"):
    is_normal = detect_offensive_language(text)
    offence_msg = "Inappropriate language" if not is_normal else ""
    return f"{text}|{language_code}|{'T' if is_normal else 'F'}|{offence_msg}"


# Test Cases
test_cases = [
    ("Hello, how are you?", "en"),      # Normal (T)
    ("Youâ€™re a worthless idiot!", "en"), # Offensive (F)
    ("Das ist scheiÃŸe!", "de"),         # Offensive (F)
    ("Bonjour, merci!", "fr"),         # Normal (T)
    ("Â¡Eres estÃºpido!", "es")           # Offensive (F)
]

for text, lang in test_cases:
    print(format_output(text, lang))


==========================================================================
#Updated Prompt (More Detailed & Multilingual)

def get_detection_prompt(text):
    return f"""
    **Task**: Detect if the text is offensive (False) or normal (True).  
    **Scope**: Global (all languages).  

    **Offensive Content Includes**:  
    - Profanity, slurs, hate speech, threats.  
    - Sexual/violent content, harassment, severe toxicity.  
    - Context matters (e.g., medical terms vs. insults).  

    **Normal Content**: Neutral, polite, or professional language.  

    **Output Rules**:  
    1. Return ONLY "True" (normal) or "False" (offensive).  
    2. Never elaborate.  

    **Examples**:  
    - "Hello" â†’ True  
    - "F*** you" â†’ False  
    - "Idiota" (Spanish) â†’ False  

    **Analyze**: "{text}"  
    """

##Updated Detection Function (Localized Messages)

def detect_offensive_language(text):
    try:
        response = client.chat.completions.create(
            model="gpt-4",
            messages=[
                {"role": "system", "content": "You are a strict multilingual content moderator. Respond ONLY with 'True' or 'False'."},
                {"role": "user", "content": get_detection_prompt(text)}
            ],
            temperature=0.0
        )
        return response.choices[0].message.content.strip() == "True"
    except Exception as e:
        print(f"Error: {e}")
        return True  # Default to non-offensive


#Updated Output Formatter (Language-Specific Messages)

def get_localized_offense_message(language_code):
    # Map of language codes to "Inappropriate Language" translations
    offense_messages = {
        "en": "Inappropriate language",
        "es": "Lenguaje inapropiado",
        "fr": "Langage inappropriÃ©",
        "de": "Unangemessene Sprache",
        "hi": "à¤…à¤¨à¥à¤šà¤¿à¤¤ à¤­à¤¾à¤·à¤¾",
        "ja": "ä¸é©åˆ‡ãªè¨€èª",
        "zh": "ä¸é€‚å½“çš„è¯­è¨€",
        "ar": "Ù„ØºØ© ØºÙŠØ± Ù„Ø§Ø¦Ù‚Ø©",
        "ru": "ĞĞµĞ´Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ğ¼Ñ‹Ğ¹ ÑĞ·Ñ‹Ğº",
        "pt": "Linguagem inadequada",
        # Add more languages as needed (cover all ISO 639-1 codes)
    }
    return offense_messages.get(language_code, "Inappropriate language")  # Default to English
100+ Test Cases (Global Coverage)
python
test_cases = [
    # English
    ("Hello", "en", "T", ""),
    ("Go to hell", "en", "F", "Inappropriate language"),
    # Spanish
    ("Hola", "es", "T", ""),
    ("EstÃºpido", "es", "F", "Lenguaje inapropiado"),
    # French
    ("Bonjour", "fr", "T", ""),
    ("Connard", "fr", "F", "Langage inappropriÃ©"),
    # German
    ("Guten Tag", "de", "T", ""),
    ("Arschloch", "de", "F", "Unangemessene Sprache"),
    # Hindi
    ("à¤¨à¤®à¤¸à¥à¤¤à¥‡", "hi", "T", ""),
    ("à¤¬à¥‡à¤µà¤•à¥‚à¤«", "hi", "F", "à¤…à¤¨à¥à¤šà¤¿à¤¤ à¤­à¤¾à¤·à¤¾"),
    # Japanese
    ("ã“ã‚“ã«ã¡ã¯", "ja", "T", ""),
    ("ãƒã‚«", "ja", "F", "ä¸é©åˆ‡ãªè¨€èª"),
    # Chinese
    ("ä½ å¥½", "zh", "T", ""),
    ("æ··è›‹", "zh", "F", "ä¸é€‚å½“çš„è¯­è¨€"),
    # Arabic
    ("Ù…Ø±Ø­Ø¨Ø§", "ar", "T", ""),
    ("Ø£Ø­Ù…Ù‚", "ar", "F", "Ù„ØºØ© ØºÙŠØ± Ù„Ø§Ø¦Ù‚Ø©"),
    # Russian
    ("ĞŸÑ€Ğ¸Ğ²ĞµÑ‚", "ru", "T", ""),
    ("Ğ¸Ğ´Ğ¸Ğ¾Ñ‚", "ru", "F", "ĞĞµĞ´Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ğ¼Ñ‹Ğ¹ ÑĞ·Ñ‹Ğº"),
    # Portuguese
    ("OlÃ¡", "pt", "T", ""),
    ("Idiota", "pt", "F", "Linguagem inadequada"),
    # ... Add 90+ more test cases here
]

for text, lang, expected_flag, expected_msg in test_cases:
    is_normal = detect_offensive_language(text)
    offense_msg = get_localized_offense_message(lang) if not is_normal else ""
    output = f"{text}|{lang}|{'T' if is_normal else 'F'}|{offense_msg}"
    assert output == f"{text}|{lang}|{expected_flag}|{expected_msg}", f"Test failed: {text}"
    print(output)



+++++++++++++++++++++++++++++++
+++++++++++++++++++++++++++++
from openai import AzureOpenAI

# Initialize Azure OpenAI client
client = AzureOpenAI(
    api_key="your-api-key",
    api_version="2023-05-15",
    azure_endpoint="your-endpoint"
)

def get_detection_prompt(text):
    return f"""
    Analyze this text for offensive content in any language.
    Return ONLY 'True' (normal) or 'False' (offensive).
    Consider: profanity, hate speech, threats, sexual content.
    
    Examples:
    - "Hello" â†’ True
    - "F*** you" â†’ False
    - "Idiota" â†’ False
    
    Text: "{text}"
    """

def detect_offensive_language(text):
    try:
        response = client.chat.completions.create(
            model="gpt-4",
            messages=[
                {"role": "system", "content": "You are a strict multilingual content moderator. Respond ONLY with 'True' or 'False'."},
                {"role": "user", "content": get_detection_prompt(text)}
            ],
            temperature=0.0,
            max_tokens=10
        )
        return response.choices[0].message.content.strip() == "True"
    except Exception as e:
        print(f"Error: {e}")
        return True  # Fail-safe

def get_localized_message(lang_code):
    return {
        "en": "Inappropriate language",
        "es": "Lenguaje inapropiado",
        "fr": "Langage inappropriÃ©",
        "de": "Unangemessene Sprache",
        "it": "Linguaggio inappropriato",
        "pt": "Linguagem inadequada",
        "ru": "ĞĞµĞ´Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ğ¼Ñ‹Ğ¹ ÑĞ·Ñ‹Ğº",
        "zh": "ä¸é€‚å½“çš„è¯­è¨€",
        "ja": "ä¸é©åˆ‡ãªè¨€èª",
        "ar": "Ù„ØºØ© ØºÙŠØ± Ù„Ø§Ø¦Ù‚Ø©",
        "hi": "à¤…à¤¨à¥à¤šà¤¿à¤¤ à¤­à¤¾à¤·à¤¾",
        "ko": "ë¶€ì ì ˆí•œ ì–¸ì–´",
        "th": "à¸ à¸²à¸©à¸²à¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¹€à¸«à¸¡à¸²à¸°à¸ªà¸¡",
        "vi": "NgÃ´n ngá»¯ khÃ´ng phÃ¹ há»£p",
        "nl": "Ongepaste taal",
        "sv": "OlÃ¤mpligt sprÃ¥k",
        "fi": "Sopimaton kieli",
        "da": "Upassende sprog",
        "no": "Upassende sprÃ¥k",
        "pl": "NiewÅ‚aÅ›ciwy jÄ™zyk",
        "tr": "Uygunsuz dil",
        "he": "×©×¤×” ×œ× ×”×•×œ××ª",
        "id": "Bahasa tidak pantas",
        "ms": "Bahasa tidak sesuai",
        "tl": "Hindi angkop na wika",
        "hu": "Nem megfelelÅ‘ nyelv",
        "cs": "NevhodnÃ½ jazyk",
        "el": "Î‘ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î· Î³Î»ÏÏƒÏƒÎ±",
        "ro": "Limbaj inadecvat",
        "sk": "NevhodnÃ½ jazyk",
        "bg": "ĞĞµĞ¿Ñ€Ğ¸Ğ»Ğ¸Ñ‡ĞµĞ½ ĞµĞ·Ğ¸Ğº",
        "uk": "ĞĞµĞ¿Ñ€Ğ¸Ğ¹Ğ½ÑÑ‚Ğ½Ğ° Ğ¼Ğ¾Ğ²Ğ°",
        "fa": "Ø²Ø¨Ø§Ù† Ù†Ø§Ù…Ù†Ø§Ø³Ø¨",
        "ur": "Ù†Ø§Ù…Ù†Ø§Ø³Ø¨ Ø²Ø¨Ø§Ù†",
        "bn": "à¦…à¦¨à§à¦ªà¦¯à§à¦•à§à¦¤ à¦­à¦¾à¦·à¦¾",
        "ta": "à®ªà¯Šà®°à¯à®¤à¯à®¤à®®à®±à¯à®± à®®à¯Šà®´à®¿",
        "te": "à°¤à°—à°¨à°¿ à°­à°¾à°·",
        "mr": "à¤…à¤¯à¥‹à¤—à¥à¤¯ à¤­à¤¾à¤·à¤¾",
        "gu": "àª…àª¯à«‹àª—à«àª¯ àª­àª¾àª·àª¾",
        "kn": "à²…à²¨à³à²šà²¿à²¤ à²­à²¾à²·à³†",
        "ml": "à´…à´¨àµà´šà´¿à´¤à´®à´¾à´¯ à´­à´¾à´·",
        "pa": "à¨—à¨¼à¨²à¨¤ à¨­à¨¾à¨¸à¨¼à¨¾",
        "ne": "à¤…à¤¨à¥à¤šà¤¿à¤¤ à¤­à¤¾à¤·à¤¾",
        "si": "à¶±à·”à·ƒà·”à¶¯à·”à·ƒà·” à¶·à·à·‚à·à·€",
        "km": "á—á¶áŸá¶á˜á·á“áŸá˜ášá˜áŸ’á™",
        "my": "á€™á€á€„á€·á€ºá€œá€»á€±á€¬á€ºá€á€±á€¬á€˜á€¬á€á€¬á€…á€€á€¬á€¸",
        "lo": "àºàº²àºªàº²àº—àºµà»ˆàºšà»à»ˆà»€à»àº²àº°àºªàº»àº¡",
        "jw": "Basa sing ora pantes",
        "su": "Basa teu pantes",
        "yo": "Ede ti o ye",
        "ig": "Asá»¥sá»¥ na-ekwesá»‹ghá»‹ ekwesá»‹",
        "zu": "Ulimi olungafanele",
        "xh": "Ulwimi olungafanelekanga",
        "sn": "Mutauro usingakodzeri",
        "st": "Puo e sa loketseng",
        "sw": "Lugha isiyofaa",
        "am": "á‹¨áˆ›á‹­áŒˆá‰£ á‰‹áŠ•á‰‹",
        "ha": "Harshen da bai dace ba",
        "so": "Afka aan habboon",
        "af": "Onvanpaste taal",
        "az": "UyÄŸunsuz dil",
        "be": "ĞĞµĞ°Ğ´Ğ¿Ğ°Ğ²ĞµĞ´Ğ½Ğ°Ñ Ğ¼Ğ¾Ğ²Ğ°",
        "ca": "Llenguatge inadequat",
        "cy": "Iaith amhriodol",
        "et": "Sobimatu keel",
        "eu": "Hizkuntza desegokia",
        "gl": "Linguaxe inadecuada",
        "hr": "Neprikladan jezik",
        "hy": "Õ€Õ¡Ö€Õ´Õ¡Ö€ Õ¹Õ§ Õ¬Õ¥Õ¦Õ¸Ö‚",
        "is": "Ã“viÃ°eigandi tungumÃ¡l",
        "ka": "áƒáƒ áƒáƒ¨áƒ”áƒ¡áƒáƒ‘áƒáƒ›áƒ˜áƒ¡áƒ˜ áƒ”áƒœáƒ",
        "kk": "ÒšĞ¾Ğ»Ğ°Ğ¹ÑÑ‹Ğ· Ñ‚Ñ–Ğ»",
        "ky": "Ğ«Ğ»Ğ°Ğ¹Ñ‹ĞºÑÑ‹Ğ· Ñ‚Ğ¸Ğ»",
        "lt": "Netinkama kalba",
        "lv": "NepiemÄ“rota valoda",
        "mk": "ĞĞµÑĞ¾Ğ¾Ğ´Ğ²ĞµÑ‚ĞµĞ½ Ñ˜Ğ°Ğ·Ğ¸Ğº",
        "mn": "Ğ¢Ğ¾Ñ…Ğ¸Ñ€Ğ¾Ğ¼Ğ¶Ñ‚Ğ¾Ğ¹ Ğ±ÑƒÑ Ñ…ÑĞ»",
        "mt": "Lingwa mhux xierqa",
        "sl": "Neprimeren jezik",
        "sq": "GjuhÃ« e papÃ«rshtatshme",
        "sr": "ĞĞµĞ¿Ñ€Ğ¸ĞºĞ»Ğ°Ğ´Ğ°Ğ½ Ñ˜ĞµĞ·Ğ¸Ğº",
        "tg": "Ğ—Ğ°Ğ±Ğ¾Ğ½Ğ¸ Ğ½Ğ¾Ğ¼ÑƒĞ½Ğ¾ÑĞ¸Ğ±",
        "tk": "NÃ¤dogry dil",
        "uz": "Noo'rin til",
    }.get(lang_code, "Inappropriate language")

def format_output(text, lang_code="en"):
    is_normal = detect_offensive_language(text)
    msg = "" if is_normal else get_localized_message(lang_code)
    return f"{text}|{lang_code}|{'T' if is_normal else 'F'}|{msg}"

# Test cases - Now only need (text, lang_code)
test_cases = [
    # English
    ("Hello", "en"),
    ("You're an idiot", "en"),
    
    # Spanish
    ("Hola", "es"),
    ("Eres estÃºpido", "es"),
    
    # French
    ("Bonjour", "fr"),
    ("Connard", "fr"),
    
    # German
    ("Guten Tag", "de"),
    ("Dummkopf", "de"),
    
    # Japanese
    ("ã“ã‚“ã«ã¡ã¯", "ja"),
    ("ãƒã‚«", "ja"),
    
    # Russian
    ("ĞŸÑ€Ğ¸Ğ²ĞµÑ‚", "ru"),
    ("Ğ˜Ğ´Ğ¸Ğ¾Ñ‚", "ru"),
    
    # Arabic
    ("Ù…Ø±Ø­Ø¨Ø§", "ar"),
    ("Ø£Ø­Ù…Ù‚", "ar"),
    
    # Hindi
    ("à¤¨à¤®à¤¸à¥à¤¤à¥‡", "hi"),
    ("à¤¬à¥‡à¤µà¤•à¥‚à¤«", "hi"),
    
    # Chinese
    ("ä½ å¥½", "zh"),
    ("ç¬¨è›‹", "zh"),
    
    # ... Add 90+ more test cases
]

# Automated testing
for text, lang_code in test_cases:
    result = format_output(text, lang_code)
    print(result)



*****************************
****************************
**************************

test_cases = [
    # English (10)
    ("Welcome", "en"),
    ("Thanks for your help", "en"),
    ("Go to hell", "en"),
    ("Piece of shit", "en"),
    ("I appreciate you", "en"),
    ("You're worthless", "en"),
    ("Have a nice day", "en"),
    ("F*** off", "en"),
    ("Brilliant work", "en"),
    ("Kiss my ass", "en"),

    # Spanish (10)
    ("Gracias", "es"),
    ("Eres tonto", "es"),
    ("Buenos dÃ­as", "es"),
    ("Hijo de puta", "es"),
    ("Te quiero", "es"),
    ("Vete al diablo", "es"),
    ("Excelente trabajo", "es"),
    ("EstÃºpido", "es"),
    ("Por favor", "es"),
    ("Maldito idiota", "es"),

    # French (10)
    ("Merci", "fr"),
    ("Salaud", "fr"),
    ("Bon appÃ©tit", "fr"),
    ("Va te faire voir", "fr"),
    ("Je t'aime", "fr"),
    ("Connasse", "fr"),
    ("Pardon", "fr"),
    ("Fils de pute", "fr"),
    ("Magnifique", "fr"),
    ("Putain", "fr"),

    # German (10)
    ("Danke", "de"),
    ("Arschloch", "de"),
    ("Guten Appetit", "de"),
    ("Halt die Klappe", "de"),
    ("Ich liebe dich", "de"),
    ("ScheiÃŸe", "de"),
    ("Bitte", "de"),
    ("Wichser", "de"),
    ("Fantastisch", "de"),
    ("Vollidiot", "de"),

    # Asian Languages (30)
    # Japanese (5)
    ("ã‚ã‚ŠãŒã¨ã†", "ja"),
    ("ãƒã‚«", "ja"),
    ("ãŠã¯ã‚ˆã†", "ja"),
    ("ã‚¯ã‚½é‡éƒ", "ja"),
    ("æ„›ã—ã¦ã‚‹", "ja"),

    # Chinese (5)
    ("è°¢è°¢", "zh"),
    ("ç¬¨è›‹", "zh"),
    ("æ—©ä¸Šå¥½", "zh"),
    ("ä»–å¦ˆçš„", "zh"),
    ("æˆ‘çˆ±ä½ ", "zh"),

    # Korean (5)
    ("ê°ì‚¬í•©ë‹ˆë‹¤", "ko"),
    ("ë°”ë³´", "ko"),
    ("ì•ˆë…•í•˜ì„¸ìš”", "ko"),
    ("ì”¨ë°œ", "ko"),
    ("ì‚¬ë‘í•´", "ko"),

    # Hindi (5)
    ("à¤§à¤¨à¥à¤¯à¤µà¤¾à¤¦", "hi"),
    ("à¤®à¥‚à¤°à¥à¤–", "hi"),
    ("à¤¸à¥à¤ªà¥à¤°à¤­à¤¾à¤¤", "hi"),
    ("à¤šà¥‚à¤¤à¤¿à¤¯à¤¾", "hi"),
    ("à¤ªà¥à¤¯à¤¾à¤°", "hi"),

    # Thai (5)
    ("à¸‚à¸­à¸šà¸„à¸¸à¸“", "th"),
    ("à¹‚à¸‡à¹ˆ", "th"),
    ("à¸ªà¸§à¸±à¸ªà¸”à¸µ", "th"),
    ("à¹„à¸­à¹‰à¹‚à¸‡à¹ˆ", "th"),
    ("à¸£à¸±à¸", "th"),

    # Vietnamese (5)
    ("Cáº£m Æ¡n", "vi"),
    ("Äá»“ ngá»‘c", "vi"),
    ("Xin chÃ o", "vi"),
    ("Äá»‹t máº¹", "vi"),
    ("YÃªu", "vi"),

    # Middle Eastern (15)
    # Arabic (5)
    ("Ø´ÙƒØ±Ø§", "ar"),
    ("Ø£Ø­Ù…Ù‚", "ar"),
    ("ØµØ¨Ø§Ø­ Ø§Ù„Ø®ÙŠØ±", "ar"),
    ("Ø§Ø¨Ù† Ø§Ù„ÙƒÙ„Ø¨", "ar"),
    ("Ø£Ø­Ø¨Ùƒ", "ar"),

    # Hebrew (5)
    ("×ª×•×“×”", "he"),
    ("××™×“×™×•×˜", "he"),
    ("×‘×•×§×¨ ×˜×•×‘", "he"),
    ("×‘×Ÿ ×–×•× ×”", "he"),
    ("×× ×™ ××•×”×‘ ××•×ª×š", "he"),

    # Turkish (5)
    ("TeÅŸekkÃ¼rler", "tr"),
    ("Aptal", "tr"),
    ("GÃ¼naydÄ±n", "tr"),
    ("Orospu Ã§ocuÄŸu", "tr"),
    ("Seni seviyorum", "tr"),

    # European (25)
    # Italian (5)
    ("Grazie", "it"),
    ("Stupido", "it"),
    ("Buongiorno", "it"),
    ("Figlio di puttana", "it"),
    ("Ti amo", "it"),

    # Portuguese (5)
    ("Obrigado", "pt"),
    ("Idiota", "pt"),
    ("Bom dia", "pt"),
    ("Filho da puta", "pt"),
    ("Amo-te", "pt"),

    # Russian (5)
    ("Ğ¡Ğ¿Ğ°ÑĞ¸Ğ±Ğ¾", "ru"),
    ("Ğ˜Ğ´Ğ¸Ğ¾Ñ‚", "ru"),
    ("Ğ”Ğ¾Ğ±Ñ€Ğ¾Ğµ ÑƒÑ‚Ñ€Ğ¾", "ru"),
    ("Ğ¡ÑƒĞºĞ¸Ğ½ ÑÑ‹Ğ½", "ru"),
    ("Ğ¯ Ñ‚ĞµĞ±Ñ Ğ»ÑĞ±Ğ»Ñ", "ru"),

    # Dutch (5)
    ("Dank je", "nl"),
    ("Idioot", "nl"),
    ("Goedemorgen", "nl"),
    ("Klootzak", "nl"),
    ("Ik hou van je", "nl"),

    # Polish (5)
    ("DziÄ™kujÄ™", "pl"),
    ("Idiota", "pl"),
    ("DzieÅ„ dobry", "pl"),
    ("Sukinsyn", "pl"),
    ("Kocham ciÄ™", "pl"),

    # Edge Cases (10)
    ("", "en"),  # Empty string
    (" ", "es"),  # Whitespace
    ("12345", "fr"),  # Numbers
    ("@#$%^", "de"),  # Symbols
    ("Hello ä½ å¥½", "zh"),  # Mixed languages
    ("CafÃ©", "pt"),  # Accented characters
    ("ğŸ¤¬", "ja"),  # Emoji
    ("I'm not angry", "en"),  # Negative phrasing
    ("This is a long sentence that should pass normally without issues", "en"),
    ("ä½  å¥½", "zh")  # Space between characters
]
